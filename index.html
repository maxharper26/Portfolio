<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Max Harper Modelling and Technology Projects</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <div class="container">
      <div class="header-content">
        <h1>Max Harper</h1>
        <p class="subtitle">Modelling and Technology Projects</p>
        <div class="nav-links">
          <a href="CV.pdf" target="_blank" class="nav-link">ðŸ“„ CV</a>
          <a href="Thesis.pdf" target="_blank" class="nav-link">ðŸŽ“ Honours Thesis</a>
        </div>
      </div>
    </div>
  </header>
  
  <main>
    <div class="container">
      <div class="toc-container">
        <h2 class="toc-title">Projects</h2>
        <div id="loading" class="loading-state">Loading projects...</div>
        <ul class="toc-list" id="toc-list" style="display: none;">
          <!-- Dynamic content will be inserted here -->
        </ul>
      </div>
    </div>
  </main>
  
  <footer>
    <div class="container">
      &copy; 2025 Max Harper | Hosted on GitHub Pages
    </div>
  </footer>

  <script>
    // GitHub API configuration
    const GITHUB_API_BASE = 'https://api.github.com/repos/maxharper26/Portfolio/contents';
    
    // Project configuration with icons and descriptions
    const PROJECT_CONFIG = {
      'Trading': {
        icon: 'ðŸ“ˆ',
        description: 'Quantitative trading strategies, risk analysis, and portfolio optimization'
      },
      'Consulting': {
        icon: 'ðŸ’¼', 
        description: 'Data analytics and business intelligence solutions for client engagements'
      },
      'Greyhounds': {
        icon: 'ï¿½',
        description: 'Machine learning models for racing predictions and performance analysis'
      }
    };
    
    // Function to sanitize folder names for display
    function sanitizeFolderName(folderName) {
      return folderName
        .replace(/[-_]/g, ' ')  // Replace hyphens and underscores with spaces
        .replace(/([A-Z])/g, ' $1')  // Add space before capital letters
        .replace(/\s+/g, ' ')  // Collapse multiple spaces
        .trim()  // Remove leading/trailing spaces
        .replace(/\b\w/g, l => l.toUpperCase());  // Capitalize first letter of each word
    }
    
    // Function to fetch folder contents from GitHub API
    async function fetchFolderContents(folderPath) {
      try {
        const response = await fetch(`${GITHUB_API_BASE}/${folderPath}`);
        if (!response.ok) {
          throw new Error(`HTTP ${response.status}: ${response.statusText}`);
        }
        const data = await response.json();
        return data.filter(item => item.type === 'dir');  // Only return directories
      } catch (error) {
        console.error(`Error fetching ${folderPath}:`, error);
        return [];
      }
    }
    
    // Function to build the dynamic table of contents
    async function buildTableOfContents() {
      const tocList = document.getElementById('toc-list');
      const loading = document.getElementById('loading');
      
      try {
        let sectionNumber = 1;
        
        // Process each main project folder
        for (const [folderName, config] of Object.entries(PROJECT_CONFIG)) {
          // Fetch subfolders
          const subfolders = await fetchFolderContents(folderName);
          
          // Create main project section
          const mainItem = document.createElement('li');
          mainItem.className = 'toc-item main-project';
          
          mainItem.innerHTML = `
            <span class="toc-number">${sectionNumber}</span>
            <div class="toc-content">
              <div class="toc-link main-project-title">
                <span class="toc-icon">${config.icon}</span>${sanitizeFolderName(folderName)}
              </div>
              <div class="toc-description">${config.description}</div>
            </div>
            <div class="toc-dots"></div>
          `;
          
          tocList.appendChild(mainItem);
          
          // Add subprojects if they exist
          if (subfolders.length > 0) {
            subfolders.forEach((subfolder, index) => {
              const subItem = document.createElement('li');
              subItem.className = 'toc-item sub-project';
              
              subItem.innerHTML = `
                <span class="toc-number">${sectionNumber}.${index + 1}</span>
                <div class="toc-content">
                  <a href="${folderName}/${subfolder.name}/" class="toc-link sub-project-link">
                    <span class="toc-icon">ï¿½</span>${sanitizeFolderName(subfolder.name)}
                  </a>
                </div>
                <div class="toc-dots"></div>
              `;
              
              tocList.appendChild(subItem);
            });
          }
          
          sectionNumber++;
        }
        
        // Show the completed table of contents
        loading.style.display = 'none';
        tocList.style.display = 'block';
        
      } catch (error) {
        console.error('Error building table of contents:', error);
        loading.innerHTML = 'Error loading projects. Please refresh the page.';
      }
    }
    
    // Load the table of contents when page loads
    document.addEventListener('DOMContentLoaded', buildTableOfContents);
  </script>
</body>
</html>
